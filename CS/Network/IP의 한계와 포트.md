## IP의 한계

### 🔹 신뢰할 수 없는 통신 (최선형 전달)

- 패킷이 수신지까지 제대로 전송되었는지 보장하지 않음
- 최선을 다하지만, 결과는 책임지지 않음

### 🔹 비연결성 통신

- 송수신 호스트 간에 사전 연결 수립 없이 패킷 전송
- 목적지로 그냥 던지는 방식 (Connectionless)

---

## 전송 계층

### 🔸 TCP (Transmission Control Protocol)

- **연결형 통신**
  - 송수신 전에 연결 수립
  - 통신이 끝나면 연결 종료
- **신뢰성 있는 통신**
  - 패킷을 순서대로, 빠짐 없이, 중복 없이 보장

### 🔸 UDP (User Datagram Protocol)

- **비연결형 통신, 신뢰성 없음**
- 빠른 전송이 장점 (예: 실시간 스트리밍, 게임 등)

---

## IP vs TCP/UDP

| 항목       | IP (Internet Protocol) | TCP/UDP (전송 계층 프로토콜)            |
| -------- | ---------------------- | ------------------------------- |
| 계층       | 네트워크 계층                | 전송 계층                           |
| 주요 목적    | 호스트 간 데이터 전달           | 프로세스 간 데이터 전달                   |
| 연결 방식    | 비연결형 (Connectionless)  | TCP: 연결형 / UDP: 비연결형            |
| 신뢰성 보장   | 없음                     | TCP: 있음 / UDP: 없음               |
| 데이터 단위   | 패킷(Packet)             | TCP: 세그먼트(Segment) / UDP: 데이터그램 |
| 주소 정보    | IP 주소                  | IP 주소 + 포트 번호                   |
| 오류 처리    | 없음 (오류 감지 불가)          | TCP: 있음 / UDP: 간단한 체크섬만 제공      |
| 흐름/혼잡 제어 | 없음                     | TCP: 있음 / UDP: 없음               |
| 사용 예시    | 모든 인터넷 통신의 기반          | TCP: 웹, 이메일 / UDP: 스트리밍, 게임 등   |

---

## 포트(Port)

- 패킷에 포함된 **특정 애플리케이션 식별 정보**
- 전송 계층에서 포트 번호를 통해 특정 프로세스를 식별

### 포트 번호 종류

| 범위            | 구분                    | 설명                                               |
| ------------- | --------------------- | ------------------------------------------------ |
| 0 ~ 1023      | 잘 알려진 포트 (Well-known) | 범용적으로 사용되는 서비스 (예: HTTP 80, HTTPS 443, FTP 21 등) |
| 1024 ~ 49151  | 등록된 포트 (Registered)   | 덜 일반적이지만, 특정 앱에 등록된 포트                           |
| 49152 ~ 65535 | 동적 포트 (Ephemeral, 임시) | 임시로 할당되는 포트, 클라이언트가 주로 사용                        |

### 서버 vs 클라이언트 포트 사용 방식

| 구분       | 서버 프로그램               | 클라이언트 프로그램             |
| -------- | --------------------- | ---------------------- |
| 포트 번호 종류 | 고정 포트 (well-known 포트) | 동적 포트 (ephemeral port) |
| 번호 설정 방식 | 사전에 암묵적으로 정해져 있음      | 운영체제가 임의로 포트 번호를 할당    |
| 사용하는 이유  | 클라이언트가 어디로 접속할지 알아야 함 | 서버와 통신을 위한 포트가 필요      |
| 특징       | 정해진 포트에서 항상 대기        | 매번 접속마다 다른 포트 번호 사용 가능 |

---

## NAT (Network Address Translation)

- 하나의 **공인 IP 주소로 여러 사설 IP를 공유**할 수 있게 해주는 기술
- 사설 IP ↔ 공인 IP 변환 테이블을 관리
- IP 부족 문제 해결에 효과적

### 🔹 NAPT (또는 PAT, APT) - 포트 기반 NAT

- 포트까지 함께 변환하여 다수 장비를 식별 가능
- NAT 테이블에 사설 IP + 포트와 공인 IP + 포트 쌍을 저장
- 외부에서 통신이 들어올 경우, 테이블을 참조해 내부 호스트 식별

#### 💡 외부에서 먼저 접근하려면?

- NAT는 요청 기록이 없으면 내부 대상 호스트를 알 수 없음
- **포트 포워딩 설정 필요**

---

## 포트 포워딩

- **외부 → 내부로의 접속을 가능하게 하기 위한 NAT 설정**
- 특정 공인 IP + 포트 쌍을 특정 사설 IP + 포트로 전달
- 주로 내부 서버(NAS, CCTV, 웹서버 등)에 외부에서 접속할 때 사용

---

## ICMP (Internet Control Message Protocol)

- IP 프로토콜의 **보조 프로토콜**
- **오류 메시지**나 **진단 메시지**를 전송하는 용도
- 대표적인 사용: `ping`, `traceroute`

### 주요 기능

1. 오류 보고  
   - 목적지 도달 불가, TTL 초과 등
2. 네트워크 진단  
   - 연결 확인, 경로 추적 등

### 구성

| 필드   | 설명                         |
| ---- | -------------------------- |
| Type | 메시지 종류 (예: Echo Request=8) |
| Code | 상세 사유 코드                   |

> ※ ICMP는 자체 데이터 전송은 하지 않으며, **다른 통신(IP)의 보조로 사용**됩니다.
